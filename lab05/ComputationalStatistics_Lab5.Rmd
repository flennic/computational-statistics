---
title: "Computational Statistics - Lab 05"
author: "Annalena Erhard (anner218) and Maximilian Pfundstein (maxpf364)"
date: "`r Sys.Date()`"
output:
  html_document:
    df_print: paged
    toc: true
    toc_float: false
    number_sections: false
  pdf_document:
    toc: true
    toc_depth: 3
    number_sections: true
---

```{r libraries, echo=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = FALSE, include = TRUE, eval = TRUE)
library(knitr)
library(readxl)
library(ggplot2)
library(gridExtra)
```

# Question 1: Hypothesis testing

In 1970, the US Congress instituted a random selection process for the military draft. All 366 possible birth dates were placed in plastic capsules in a rotating drum and were selected one by one. The first date drawn from the drum received draft number one, the second date drawn received draft number two, etc. Then, eligible men were drafted in the order given by the draft number of their birth date. In a truly random lottery there should be no relationship between the date and the draft number. Your task is to investigate whether or not the draft numbers were randomly selected. The draft numbers ($Y=Draft No$) sorted by day of year ($X=\text{Day of year}$) are given in the file ```lottery.xls```.


```{r, echo = FALSE}

lottery = read_xls("lottery.xls")
kable(head(lottery))

```

1. Make a scatterplot of Y versus X and conclude whether the lottery looks random. 

```{r, echo = FALSE}

ggplot(lottery)+
  geom_point(aes(x = Day_of_year, y = Draft_No), color = "#900C3F") +
  labs(title = "Day of Year VS Draft Number",
       y = "Draft Number",  x = "Day of Year", color = "Legend") +
  theme_minimal()

```

**Answer:** In the plot, it the lottery appears to be random, because of the relatively even distribution of the points over the area.

2. Compute an estimate $\hat{Y} $ of the expected response as a function of $X$ by using a loess smoother (use `loess()`), put the curve $\hat{Y} $ versus $X$ in the previous graph and state again whether the lottery looks random.

```{r}
ggplot(lottery)+
  geom_point(aes(x = Day_of_year, y = Draft_No), color = "#900C3F") +
  geom_smooth(mapping = aes(x = Day_of_year, y = Draft_No),
              method = "loess", size = 1.5 ) +
  labs(title = "Day of Year VS Draft Number",
       y = "Draft Number",  x = "Day of Year", color = "Legend") +
  theme_minimal()
  
```

**Answer:** Including the insights from this smoothing we see, that the lootery actually doesn not look random. There are two reasons for this:

- The confidence interval of the curve is relatively small, especially compared to the spread of the data points.
- The data points follow the pattern of the curve slightly, especially above the line. 

3. To check whether the lottery is random, it is reasonable to use test statistics

$$T = \frac{\hat{Y}(X_{b})-\hat{Y}(X_{a})}{X_{b}-X_{a}}, \: \text{where} X_b = \text{argmax}_XY(X),X_a = \text{argmin}_XY(X) $$
$$\text{, where} X_{b} = argmax_{X}Y(X), X_{a} = argm_{inX}Y(X)  }  $$

If this value is significantly greater than zero, then there should be a trend in the data and the lottery is not random. Estimate the distribution of T by using a non-parametric bootstrap with $B = 2000$ and comment whether the lottery is random or not. What is the p-value of the test?

**Answer:**



```{r, echo = FALSE}


```




# Question 2: Bootstrap, jackknife and confidence intervals



```{r}


```



# Source Code

```{r, ref.label=knitr::all_labels(), echo = TRUE, eval = FALSE, results = 'show'}

```