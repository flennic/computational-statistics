---
title: "Computational Statistics Lab 3"
author: "Annalena Erhard(anner218)"
date: "24 Januar 2019"
output: pdf_document
---

```{r libraries, echo=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = TRUE)
library(readxl)
library(ggplot2)
```

##### Question 1


An opinion pool is assumed to be performed in several locations of Sweden by sending interviewers to this location. Of course, it is unreasonable from the ﬁnancial point of view to visit each city. Instead, a decision was done to use random sampling without replacement with the probabilities proportional to the number of inhabitants of the city to select 20 cities. Explore the ﬁle ```population.xls.``` Note that names in bold are counties, not cities.



#### Task 1

**Task:**

Import necessary information to R.


```{r task 1.1}

# reading the data in -----------------------------------
data = read.csv("population.csv", sep = ";")

```


#### Task 2

**Task:**

Use a uniform random number generator to create a function that selects 1 city from the whole list by the probability scheme oﬀered above (do not use standard sampling functions present in R).


```{r task 1.2}

sample_wo_replacement = function(n, data, seed){
  samples = numeric()
  i = 1
  while (length(samples) < n) {
    set.seed(seed)
     a = round(runif(n = 1, min = 1, max = nrow(data)))
     while (a %in% samples) {
       set.seed(seed)
       a = round(runif(n = 1, min = 1, max = nrow(data)))
     }
     samples[i] = a
     i = i+1
  }
  return(samples)
}


```


#### Task 3

**Task:**
Use the function you have created in step 2 as follows:

(a) Apply it to the list of all cities and select one city


```{r task 1.3.a}

a = sample_wo_replacement(1,data, 12345)

```

(b) Remove this city from the list
```{r task 1.3.b}
cities = data[-a,]
```

(c) Apply this function again to the updated list of the cities 
(d) Remove this city from the list 
(e) ... and so on until you get exactly 20 cities.

```{r task 1.3.cde}

rownames(cities) = 1:nrow(cities)

while (nrow(cities) >20) {
  a = sample_wo_replacement(1,cities, 12345)
  cities = cities[-a,]
  rownames(cities) = 1:nrow(cities)
  print(nrow(cities))
}



```



##### Task 4

**Task:**
Run the program. Which cities were selected? What can you say about the size of the selected cities?

**Answer:**

The following cities were selected:

```{r task 1.4}

cities


```

It can be seen, that cities of all different sizes (counting the population) were selected.

##### Task 5

**Task :**
Plot one histogram showing the size of all cities of the country. Plot another histogram showing the size of the 20 selected cities. Conclusions?



```{r task 1.5}
ggplot(cities)+
  geom_histogram(aes(x = Population),bins = 15)+
  ggtitle("Histogram of selected cities")

ggplot(data)+
  geom_histogram(aes(x = Population),bins = 15)+
  ggtitle("Histogram of all cities")
```

**Answer: **

Comparing both histograms it can be seen that mostly smaller cities were selected by the sampling function. The reason for that is on the one side chance and on the other side the state of mostly smaller cities existing in Sweden.




### Question 2

##### Task 1

**Task: **



```{r task 2.1}

```


##### Task 2

**Task:**



```{r task 2.2}


```
**Answer:**


##### Task 3

**Task:**


```{r task 2.3}


```


##### Task 4

**Task: **




```{r task 4}

```










